#include <openssl/bn.h>
#include <stdio.h>
#define NBITS 256
void printBN(char *msg, BIGNUM *a) {
  /* Use BN_bn2hex(a) for hex string
  Use BN_bn2dec(a) for decimal string*/
  char *number_str = BN_bn2hex(a);
  printf("%s %s\n", msg, number_str);
  OPENSSL_free(number_str);
}
int main() {
  BN_CTX *ctx = BN_CTX_new();
  BIGNUM *s = BN_new();
  BIGNUM *n = BN_new();
  BIGNUM *e = BN_new();
  BIGNUM *message = BN_new();
  // Initialize
  BN_hex2bn(&s,
            "320df8a5fcad02f849f293502cae2574c7e82d2e99a53a0d2b1da34660b353b40d"
            "b4793c03c990cfcc89379472aaad799ba6789a7da1a453711f2bca6092eca49163"
            "d4ab42de7cfa04e6b96d6b87401db3f5d617251279f0890cb57426cb7019702553"
            "14a83eb07e9ce07eaae811bbc4b0f05ef2340ed0cc1e06ce9af0710b1b28aa7dad"
            "3202629286868483b6655268f8b0bee996f36b98e1b3f19a13eaea2f09ad5a2e90"
            "fd6f28c417003fb2af8b56fd25c622126586c881ae30422f3c009c4ee95cac0385"
            "316d04cd5df40cb99eceb68dda441d941b918e55c04bd6e903b7941a0c4d050283"
            "681719700742b55875e226cae06bc490f5128f3099d85085a0");
  BN_hex2bn(
      &n,
      "B611028B1EE3A1779B3BDCBF943EB795A7403CA1FD82F97D32068271F6F68C7FFBE8DBBC"
      "6A2E9797A38C4BF92BF6B1F9CE841DB1F9C597DEEFB9F2A3E9BC12895EA7AA52ABF82327"
      "CBA4B19C63DBD7997EF00A5EEB68A6F4C65A470D4D1033E34EB113A3C8186C4BECFC0990"
      "DF9D6429252307A1B4D23D2E60E0CFD20987BBCD48F04DC2C27A888ABBBACF5919D6AF8F"
      "B007B09E31F182C1C0DF2EA66D6C190EB5D87E261A45033DB079A49428AD0F7F26E5A808"
      "FE96E83C689453EE833A882B159609B2E07A8C2E75D69CEBA756648F964F68AE3D97C284"
      "8FC0BC40C00B5CBDF687B3356CAC18507F84E04CCD92D320E933BC5299AF32B529B3252A"
      "B448F972E1CA64F7E682108DE89DC28A88FA38668AFC63F901F978FD7B5C77FA7687FAEC"
      "DFB10E799557B4BD26EFD601D1EB160ABB8E0BB5C5C58A55ABD3ACEA914B29CC19A43225"
      "4E2AF16544D002CEAACE49B4EA9F7C83B0407BE743ABA76CA38F7D8981FA4CA5FFD58EC3"
      "CE4BE0B5D8B38E45CF76C0ED402BFD530FB0A7D53B0DB18AA203DE31ADCC77EA6F7B3ED6"
      "DF912212E6BEFAD832FC1063145172DE5DD61693BD296833EF3A66EC078A26DF13D75765"
      "7827DE5E491400A2007F9AA821B6A9B195B0A5B90D1611DAC76C483C40E07E0D5ACD563C"
      "D19705B9CB4BED394B9CC43FD255136E24B0D671FAF4C1BACCED1BF5FE8141D800983D3A"
      "C8AE7A9837180595");
  BN_hex2bn(&e, "65537");
  // Signing
  BN_mod_exp(message, s, e, n, ctx);
  printBN("Message =", message);
  return 0;
}
